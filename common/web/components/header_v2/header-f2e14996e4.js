define(function(require,e,t){"use strict";var s=require("./header-c16f59d8fd.tpl"),a="http://www.diandong.com/api/top_search.shtml",n="http://car.diandong.com/api/chexi_fuzzysearch",r=function(){this.init()};r.prototype={elements:{searchBar:$(".search-panel-input"),searchBtn:$(".j-submit-search"),suggestDialog:$('<div class="search-suggest-list"></div>')},init:function(){this.renderPlaceholder(),this.bindEvent()},bindEvent:function(){var e=this;this.elements.searchBar.on("keyup",function(t){var s=$(t.target),a=s.val();e.getSuggest(a)}),$(document).on("click",function(t){"header-search"!==$(t.target).attr("id")&&e.hideSuggest()}),this.elements.searchBtn.on("click",function(){var t=e.elements.searchBar.val()||e.elements.searchBar.attr("placeholder");window.open("http://search.diandong.com/zonghe/?words="+t)})},renderPlaceholder:function(){var e=this;$.ajax({url:a,data:{},jsonpCallback:"jsonpcallback_search",dataType:"jsonp",type:"GET",success:function(t){e.elements.searchBar.attr("placeholder",t[0].title||"")}})},getSuggest:function(e){var t=this;$.ajax({url:n,data:{keywords:e},dataType:"jsonp",type:"GET",success:function(e){e.state.err?t.hideSuggest():t.renderSuggest(e.data)}})},renderSuggest:function(e){var t=juicer(s.suggest,{list:e});this.elements.suggestDialog.html(t).appendTo(document.body),this.showSuggest()},showSuggest:function(){var e=this.elements.searchBar.offset();this.elements.searchBar.addClass("focus"),this.elements.suggestDialog.css({top:e.top+40,left:e.left})},hideSuggest:function(){this.elements.searchBar.removeClass("focus"),this.elements.suggestDialog.remove()}},t.exports=r});